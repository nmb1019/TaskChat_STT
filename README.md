# 🎙️ タスクチャット STT/TTS版 - Task Chat (Speech to Text/Text to Speech Version)

タスクチャット STT/TTS版は、OpenAIのWhisper（音声認識）、GPT-4o（対話生成）、Text to Speech（音声合成）APIを組み合わせて、タスクベースの英会話練習ができる教育向けWebアプリケーションです。

## 🌟 特徴

- **Speech to Text**: OpenAI Whisperで音声を高精度でテキストに変換
- **GPT-4o対話生成**: 最新のGPT-4oモデルで自然な応答を生成
- **GPT-4o mini TTS**: 最新のGPT-4o mini TTSモデルで高品質な音声合成
- **タスクベース学習**: 実際の場面を想定したロールプレイで実践的な英会話を学習
- **シンプルな録音インターフェース**: ボタンを押すだけで録音・応答

## 🔄 動作の仕組み

1. 「録音開始」ボタンを押して話す
2. Whisper APIで音声をテキストに変換
3. GPT-4oがテキストを理解して応答を生成
4. GPT-4o mini TTSで応答を高品質な音声に変換
5. 音声が自動再生される

## 📋 必要なもの

- Node.js (バージョン14以上)
- OpenAI APIキー（[こちら](https://platform.openai.com/api-keys)から取得）
- マイク付きのパソコン
- モダンなWebブラウザ（Chrome、Firefox、Safari、Edge）

## 🚀 セットアップ方法

### 1. コードをダウンロード

```bash
git clone https://github.com/[あなたのユーザー名]/task-chat-stt.git
cd task-chat-stt
```

または、GitHubから直接ZIPファイルをダウンロードして解凍してください。

### 2. 必要なパッケージをインストール

```bash
npm install
```

### 3. 環境変数を設定

`.env.example`ファイルをコピーして`.env`という名前で保存します：

```bash
cp .env.example .env
```

`.env`ファイルを開いて、OpenAI APIキーを設定します：

```
OPENAI_API_KEY=あなたのAPIキーをここに入力
```

### 4. サーバーを起動

```bash
npm start
```

サーバーが起動したら、ブラウザで以下のURLを開きます：

```
http://localhost:3003
```

## 🎯 使い方

1. **タスクを確認**: 画面上部に表示されるタスクを読みます
2. **録音開始**: 緑色の「録音開始」ボタンをクリックします
3. **英語で話す**: タスクに沿って英語で話します
4. **録音停止**: 赤色の「録音停止」ボタンをクリックします
5. **AIの応答を聞く**: AIが音声で応答します
6. **会話を続ける**: 必要に応じて録音と応答を繰り返します
7. **リセット**: 「会話をリセット」ボタンで最初からやり直せます

## 💡 Realtime API版との違い

| 機能 | Realtime API版 | STT/TTS版 |
|------|---------------|-----------|
| リアルタイム性 | ◎ 非常に高い | ○ 良好 |
| 音声認識精度 | ○ 良好 | ◎ 非常に高い（Whisper） |
| 応答の柔軟性 | ○ 良好 | ◎ 非常に高い（GPT-4o） |
| 音声品質 | ○ 良好 | ◎ 非常に高い（GPT-4o mini TTS） |
| 音声制御 | △ 限定的 | ◎ 高度（instructions対応） |
| コスト | △ 高め | ○ 中程度 |
| 実装の複雑さ | △ WebRTC必要 | ◎ シンプル |

## 🎯 タスクベース学習について

このアプリは、実際の場面を想定したタスクベースの英会話練習を可能にします。デフォルトでは「学校への忘れ物の問い合わせ」タスクが設定されています。

### 現在のタスク例：忘れ物の問い合わせ

- **学習者の役割**: 学校に忘れ物をした生徒
- **AIの役割**: 学校のスタッフ
- **練習内容**: 
  - 忘れ物の説明（色、形、サイズなど）
  - 場所の説明（教室番号、具体的な場所）
  - 時間の説明（最後に見た時間）
  - 個人情報の伝達（名前、クラス）

## 🔧 カスタマイズ

### タスクを変更する

`.env`ファイルの以下の項目を編集することで、異なるタスクを設定できます：

```env
# タスクのタイトル
TASK_TITLE="レストランでの注文 - Restaurant Order"

# タスクの説明（学習者向け）
TASK_DESCRIPTION="レストランで食事を注文する練習をしましょう。"

# AIへの指示
AI_INSTRUCTION="You are a friendly waiter at a restaurant..."
```

## 📁 ファイル構成

```
task-chat-stt/
├── audio-server.js      # サーバー側のコード（STT/TTS処理）
├── package.json         # プロジェクト設定ファイル
├── .env.example        # 環境変数のテンプレート
├── README.md           # このファイル
└── public/             # クライアント側のファイル
    ├── index.html      # メインページ
    └── js/
        └── session.js  # 録音と音声処理を管理
```

## 🛠️ トラブルシューティング

### 録音ができない場合
- ブラウザがマイクへのアクセスを許可しているか確認してください
- HTTPSまたはlocalhostでアクセスしているか確認してください

### 音声が再生されない場合
- ブラウザの音量設定を確認してください
- 自動再生がブロックされていないか確認してください

### APIエラーが出る場合
- OpenAI APIキーが正しく設定されているか確認してください
- APIの利用制限に達していないか確認してください

## 📄 ライセンス

このプロジェクトはMITライセンスで公開されています。

## 🤝 貢献

プルリクエストや改善提案は大歓迎です！

## 📞 サポート

質問や問題がある場合は、GitHubのIssuesに投稿してください。

---

楽しい英会話練習を！ 🎉